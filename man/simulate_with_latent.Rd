% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulate_pfci_latent.R
\name{simulate_with_latent}
\alias{simulate_with_latent}
\title{Simulate data with latent variables and oracle-FCI truth skeleton}
\usage{
simulate_with_latent(
  p_obs = 100,
  gamma = 0.05,
  n = 100,
  edge_prob_obs = 0.02,
  latent_out_deg = 3,
  w_sd = 0.8,
  errDist = c("normal", "t4", "mixt3"),
  noise_sd = 1,
  mix = 0.05,
  seed_graph = 1,
  seed_data = 2,
  truth_alpha = 0.9999,
  truth_mmax = 2,
  truth_verbose = FALSE
)
}
\arguments{
\item{p_obs}{Number of observed variables.}

\item{gamma}{Latent ratio; p_lat = max(1, round(gamma * p_obs)).}

\item{n}{Sample size.}

\item{edge_prob_obs}{Edge probability among observed nodes (i<j only).}

\item{latent_out_deg}{Mean outgoing degree for each latent to observed (Poisson).}

\item{w_sd}{SD of nonzero edge weights.}

\item{errDist}{Error distribution for SEM noise: "normal", "t4", "mixt3".}

\item{noise_sd}{Noise SD multiplier.}

\item{mix}{Mixing proportion for "mixt3" heavy tail component.}

\item{seed_graph}{Seed controlling graph + weights.}

\item{seed_data}{Seed controlling data noise draws.}

\item{truth_alpha}{Alpha for oracle-truth FCI (typical: 0.9999).}

\item{truth_mmax}{Maximum conditioning set size in oracle FCI (speed knob; e.g., 2).}

\item{truth_verbose}{Logical; verbose output from oracle FCI.}
}
\value{
A list with elements: X, truth (skel + amat), meta, sem (A,W,indices).
}
\description{
This follows the exact latent SEM + oracle truth scheme:
\itemize{
\item Build a DAG over (observed + latent) nodes with:
\itemize{
\item observed->observed edges only for i<j (acyclic)
\item latent->observed edges (Poisson out-degree)
}
\item Simulate data from linear SEM with chosen error distribution
\item Construct "truth" by running FCI on the ORACLE correlation of observed nodes
using a very large virtual sample size and alpha_truth (oracle-ish),
with m.max controlling speed (e.g., m.max = 2)
}
}
\details{
The returned truth is the \emph{skeleton} implied by the oracle-FCI PAG (not marks).
}
